(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{55:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"配置代理解决跨域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置代理解决跨域","aria-hidden":"true"}},[t._v("#")]),t._v(" 配置代理解决跨域")]),a("p",[t._v("我们知道在vue-cli中配置代理很方便，只需要在config/目录下的index.js中找到proxyTable添加即可，而在"),a("code",[t._v("nuxt")]),t._v("中同样需要修改"),a("code",[t._v("nuxt.config.js")]),t._v("配置文件。")]),a("h2",{attrs:{id:"原始配置代理方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原始配置代理方式","aria-hidden":"true"}},[t._v("#")]),t._v(" 原始配置代理方式")]),a("p",[t._v("使用"),a("code",[t._v("@nuxtjs/axios")]),t._v("和"),a("code",[t._v("@nuxtjs/proxy")]),t._v("进行代理解决跨域")]),a("h3",{attrs:{id:"_1-下载插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载插件","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.下载插件")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#下载插件\nnpm install @nuxtjs/axios --save\n#下载依赖代理\nnpm install @nuxtjs/proxy --save\n")])]),a("h3",{attrs:{id:"_2-配置插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置插件","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.配置插件")]),a("p",[t._v("在"),a("code",[t._v("nuxt.config.js")]),t._v("添加配置项："),a("code",[t._v("modules")]),t._v("和"),a("code",[t._v("proxy")]),t._v("。")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    modules"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{attrs:{class:"token string"}},[t._v("'@nuxtjs/axios'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{attrs:{class:"token string"}},[t._v("'@nuxtjs/proxy'")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{attrs:{class:"token string"}},[t._v("'/json.html'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("target"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token string"}},[t._v("'http://www.xxxx.com'")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("    "),a("span",{attrs:{class:"token comment"}},[t._v("//注意这也是一个数组")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("p",[t._v("按照上面的方式已经完成了代理，可以进行跨域请求了。")]),a("h2",{attrs:{id:"更简便的代理方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更简便的代理方式","aria-hidden":"true"}},[t._v("#")]),t._v(" 更简便的代理方式")]),a("h3",{attrs:{id:"_1-下载插件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-下载插件-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 1.下载插件")]),a("p",[t._v("这次只需要下载"),a("code",[t._v("@nuxtjs/axios")]),t._v("插件就可以完成。")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 下载插件\nnpm install @nuxtjs/axios --save\n")])]),a("h3",{attrs:{id:"_2-配置插件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置插件-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 2.配置插件")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("module"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  modules"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{attrs:{class:"token string"}},[t._v("'@nuxtjs/axios'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  axios"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token string"}},[t._v("'/api'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'http://api.example.com'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{attrs:{class:"token string"}},[t._v("'/api2'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'http://api.another-website.com'")]),t._v("\n  "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),a("p",[t._v("特别注意：此时，"),a("code",[t._v("axios")]),t._v("选项为对象("),a("code",[t._v("object")]),t._v(")，"),a("code",[t._v("proxy")]),t._v("选项为对象("),a("code",[t._v("object")]),t._v(")。")])]),a("h2",{attrs:{id:"nuxtjs-axios的配置项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nuxtjs-axios的配置项","aria-hidden":"true"}},[t._v("#")]),t._v(" @nuxtjs/axios的配置项")]),a("h3",{attrs:{id:"pathrewrite选项-重写地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pathrewrite选项-重写地址","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("pathRewrite")]),t._v("选项(重写地址)")]),a("p",[t._v("如果配置"),a("code",[t._v("pathRewrite")]),t._v("选项，可以采用第二种写法如下：")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("proxy"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{attrs:{class:"highlighted-line"}},[t._v("  "),a("span",{attrs:{class:"token string"}},[t._v("'/api/'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" target"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'http://api.example.com'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pathRewrite"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{attrs:{class:"token string"}},[t._v("'^/api/'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("''")]),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("p",[a("code",[t._v("/api/")]),t._v("将被添加到API端点的所有请求中。可以使用"),a("code",[t._v("pathRewrite")]),t._v("选项删除。")]),a("p",[t._v("因为在 ajax 的 url 中加了前缀 "),a("code",[t._v("/api")]),t._v("，而原本的接口是没有这个前缀的。")]),a("p",[t._v("所以需要通过 "),a("strong",[t._v("pathRewrite")]),t._v(" 来重写地址，将前缀 "),a("code",[t._v("/api")]),t._v(" 转为 "),a("code",[t._v("/")]),t._v("或者是"),a("code",[t._v("''")]),t._v("。")]),a("p",[t._v("如果本身的接口地址就有 "),a("code",[t._v("/api")]),t._v(" 这种通用前缀，就可以把 "),a("code",[t._v("pathRewrite")]),t._v(" 删掉。")]),a("h3",{attrs:{id:"retry选项-自动拦截失败请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#retry选项-自动拦截失败请求","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("retry")]),t._v("选项(自动拦截失败请求)")]),a("p",[t._v("可以在"),a("code",[t._v("axios")]),t._v("选项中，配置"),a("code",[t._v("retry")]),t._v("配置项，自动拦截失败请求，"),a("strong",[t._v("默认为3次")]),t._v("。")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("axios"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  retry"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" retries"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("h3",{attrs:{id:"progress选项-发出请求时显示加载栏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#progress选项-发出请求时显示加载栏","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("progress")]),t._v("选项(发出请求时显示加载栏)")]),a("p",[t._v("与"),a("code",[t._v("Nuxt.js")]),t._v("进度条集成，在发出请求时显示加载栏。"),a("strong",[t._v("（仅在浏览器上，当加载栏可用时。）")])]),a("p",[t._v("您还可以使用"),a("code",[t._v("progress")]),t._v("配置为每个请求禁用进度条。")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("this")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$axios"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$"),a("span",{attrs:{class:"token keyword"}},[t._v("get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'URL'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" progress"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("h3",{attrs:{id:"baseurl选项（服务器端默认请求地址）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#baseurl选项（服务器端默认请求地址）","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("baseURL")]),t._v("选项（服务器端默认请求地址）")]),a("p",[t._v("在服务器端使用和预先创建请求的基本URL。")]),a("h3",{attrs:{id:"browserbaseurl选项（客户端默认请求地址）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#browserbaseurl选项（客户端默认请求地址）","aria-hidden":"true"}},[t._v("#")]),a("code",[t._v("browserBaseURL")]),t._v("选项（客户端默认请求地址）")]),a("p",[t._v("在客户端使用和预先创建请求的基本URL。")])])}],!1,null,null,null);s.default=e.exports}}]);